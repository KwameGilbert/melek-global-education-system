async function updateProfile(e){e.preventDefault();const formData={name:document.getElementById("name").value,email:document.getElementById("email").value,contact:document.getElementById("contact").value,gender:document.getElementById("gender").value,dob:document.getElementById("dob").value,nationality:document.getElementById("nationality").value};try{const response=await fetch("../../../api/student/profile/updateProfile.php",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(formData)}),data=await response.json();data.success?Swal.fire({icon:"success",title:"Success",text:"Profile updated successfully!"}):Swal.fire({icon:"error",title:"Error",text:data.message||"Failed to update profile"})}catch(error){Swal.fire({icon:"error",title:"Error",text:"An error occurred while updating profile"})}}async function changePassword(e){e.preventDefault();const currentPassword=document.getElementById("current-password").value,newPassword=document.getElementById("new-password").value;if(newPassword===document.getElementById("confirm-password").value)try{const response=await fetch("../../../api/student/password/changePassword.php",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({currentPassword:currentPassword,newPassword:newPassword})}),data=await response.json();data.success?(Swal.fire({icon:"success",title:"Success",text:"Password changed successfully!"}),document.getElementById("passwordForm").reset()):Swal.fire({icon:"error",title:"Error",text:data.message||"Failed to change password"})}catch(error){Swal.fire({icon:"error",title:"Error",text:"An error occurred while changing password"})}else Swal.fire({icon:"error",title:"Error",text:"New passwords do not match!"})}function handleProfileImageUpload(){const input=document.getElementById("profile-image"),toast=Swal.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timerProgressBar:!0,didOpen:toast=>{toast.addEventListener("mouseenter",Swal.stopTimer),toast.addEventListener("mouseleave",Swal.resumeTimer)}});input.addEventListener("change",(async e=>{const file=e.target.files[0];if(!file)return;const formData=new FormData;formData.append("image",file),toast.fire({icon:"info",title:"Uploading Profile Picture...",timer:2e3});try{const response=await fetch("../../../api/student/profile/studentProfileImage.php",{method:"POST",body:formData}),data=await response.json();"success"===data.status?(document.querySelectorAll('img[alt="User Avatar"]').forEach((img=>{img.src=data.image_url})),toast.fire({icon:"success",title:"Image Uploaded Successfully!",timer:2e3})):toast.fire({icon:"error",title:data.message||"Failed to update profile image",timer:2e3})}catch(error){console.error("Error:",error),toast.fire({icon:"error",title:"Failed to upload image",timer:2e3})}}))}function initializeProfilePage(){Swal.mixin({toast:!0,position:"top-end",showConfirmButton:!1,didOpen:toast=>{toast.addEventListener("mouseenter",Swal.stopTimer),toast.addEventListener("mouseleave",Swal.resumeTimer)}}).fire({title:"Loading Profile Page...",timer:3e3,timerProgressBar:!0}),handleProfileImageUpload()}