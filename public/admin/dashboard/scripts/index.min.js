function loadAdminDashboard(){console.log("Admin Dashboard Loaded");Swal.mixin({toast:!0,position:"top-end",showConfirmButton:!1,didOpen:toast=>{toast.addEventListener("mouseenter",Swal.stopTimer),toast.addEventListener("mouseleave",Swal.resumeTimer)}}).fire({title:"Loading your Admin Dashboard...",timer:2e3,timerProgressBar:!0}),fetch("../../../api/dashboard/dashboardData.php").then((response=>response.json())).then((data=>{if(data.status){const ctx=document.getElementById("applicationsChart").getContext("2d");new Chart(ctx,{type:"bar",data:{labels:["Applicants","Admitted","Processing","Rejected","Pending Payment","Pending Processing"],datasets:[{label:"Applications Status",data:[data.metric.totalApplicants,data.metric.totalAdmitted,data.metric.totalProcessing,data.metric.totalRejected,data.metric.pendingPayment,data.metric.pendingProcessing],backgroundColor:["rgba(250, 87, 0, 0.7)","rgba(5, 198, 131, 0.7)","rgba(219, 0, 69, 0.7)","rgba(0, 92, 197, 0.7)","rgba(92, 41, 0, 0.7)","rgba(174, 0, 209, 0.7)"],borderColor:["rgba(250, 87, 0, 1)","rgba(5, 198, 131, 1)","rgba(219, 0, 69, 1)","rgba(0, 92, 197, 1)","rgba(92, 41, 0, 1)","rgba(174, 0, 209, 1)"],borderWidth:1}]},options:{responsive:!0,maintainAspectRatio:!0,scales:{y:{beginAtZero:!0,ticks:{color:"#333"}},x:{ticks:{color:"#333"}}},plugins:{legend:{display:!1}}}});document.getElementById("totalApplicants").textContent=data.metric.totalApplicants,document.getElementById("totalAdmitted").textContent=data.metric.totalAdmitted,document.getElementById("totalProcessing").textContent=data.metric.totalProcessing,document.getElementById("totalRejected").textContent=data.metric.totalRejected,document.getElementById("pendingPayment").textContent=data.metric.pendingPayment,document.getElementById("pendingProcessing").textContent=data.metric.pendingProcessing}else console.error("Error:",data.message)})).catch((error=>{console.error("Error fetching dashboard data:",error)}))}async function loadApplicants(){console.log("Applicants loaded successfully");Swal.mixin({toast:!0,position:"top-end",showConfirmButton:!1,didOpen:toast=>{toast.addEventListener("mouseenter",Swal.stopTimer),toast.addEventListener("mouseleave",Swal.resumeTimer)}}).fire({title:"Loading applicants data...",timer:2e3,timerProgressBar:!0});let applicants=[],sortOrder=!0;try{const response=await fetch("../../../api/applicants/allApplicants.php"),data=await response.json();data.status?(applicants=data.applicants,populateTable(applicants)):console.error("Error: ",data.message)}catch(error){console.error("Error fetching applicants data:",error)}function populateTable(applicantsData){const tableBody=document.getElementById("applicantTableBody");tableBody.innerHTML="",applicantsData.forEach((applicant=>{const row=document.createElement("tr");row.innerHTML=`\n        <td class="p-3 border">${applicant.name}</td>\n        <td class="p-3 border">${applicant.applicantId}</td>\n        <td class="p-3 border">${applicant.school}</td>\n        <td class="p-3 border">${applicant.program}</td>\n        <td class="p-3 border">${applicant.dateApplied}</td>\n        <td class="p-3 border">${applicant.status}</td>\n        <td class="p-4 border-b">\n          <button class="text-blue-500 view-applicant" data-applicantId="${applicant.applicantId}">View</button>\n        </td>\n      `,tableBody.appendChild(row)})),document.querySelectorAll(".view-applicant").forEach((button=>{button.addEventListener("click",(e=>{const applicantId=e.target.getAttribute("data-applicantId");console.log(`View applicant with ID: ${applicantId}`),viewApplicant(applicantId)}))}))}document.getElementById("search").addEventListener("input",(function(){const searchValue=this.value.toLowerCase();populateTable(applicants.filter((applicant=>applicant.name.toLowerCase().includes(searchValue)||applicant.applicantId.toLowerCase().includes(searchValue))))})),document.querySelectorAll("th[data-column]").forEach((link=>{link.addEventListener("click",(function(){!function(column){const sortedData=[...applicants].sort(((a,b)=>a[column]<b[column]?sortOrder?-1:1:a[column]>b[column]?sortOrder?1:-1:0));sortOrder=!sortOrder,populateTable(sortedData)}(this.getAttribute("data-column"))}))})),document.getElementById("filterBy").addEventListener("change",(function(){!function(){const filterBy=document.getElementById("filterBy").value,filterValue=document.getElementById("filterValue");filterValue.innerHTML='<option value="">Select value</option>',filterBy&&[...new Set(applicants.map((applicant=>applicant[filterBy])))].forEach((value=>{const option=document.createElement("option");option.value=value,option.textContent=value,filterValue.appendChild(option)}))}()})),document.getElementById("applyFilter").addEventListener("click",(function(){const filterBy=document.getElementById("filterBy").value,filterValue=document.getElementById("filterValue").value;populateTable(filterBy&&filterValue?applicants.filter((applicant=>applicant[filterBy]===filterValue)):applicants)}))}function viewApplicant(applicantId){console.log("Loading applicant:",applicantId),fetch(`./pages/view-applicant.php?id=${applicantId}`).then((response=>response.text())).then((applicantInfo=>{document.getElementById("main-content").innerHTML=applicantInfo,console.log(`Loaded applicant with ID: ${applicantId}`)})).catch((error=>{console.error("Error fetching applicant data:",error)}))}function loadPage(page){fetch(`./pages/${page}`).then((response=>response.text())).then((html=>{switch(document.getElementById("main-content").innerHTML=html,console.log(page),page){case"dashboard.html":loadAdminDashboard();break;case"applicants.html":loadApplicants();break;case"schools.html":initializeSchoolsPage();break;case"profile.html":loadProfile();break;case"notices.html":loadNoticesPage();break;case"settings.html":initializeSettingsPage(),initializeSecurity();break;default:console.error("No matching function for the page:",page)}})).catch((error=>console.error("Error loading page:",error))),"view-applicant.html"!=page&&localStorage.setItem("activePage",page)}async function logout(){try{(await fetch("../../../api/logout/logout.php",{method:"GET"})).ok?(Swal.fire({title:"Success",text:"Logout successful",icon:"success",showConfirmButton:!1,allowOutsideClick:!1}),window.location.href="../login/"):Swal.fire({title:"Error!",text:"Failed to log out. Please try again.",icon:"error",confirmButtonColor:"#3085d6",confirmButtonText:"OK"})}catch(error){console.log(error),Swal.fire({title:"Error!",text:"An unexpected error occurred. Please try again.",icon:"error",confirmButtonColor:"#3085d6",confirmButtonText:"OK"})}}document.querySelectorAll("a[data-page]").forEach((link=>{link.addEventListener("click",(function(event){event.preventDefault();const page=this.getAttribute("data-page");localStorage.setItem("activePage",page),loadPage(page)}))}));