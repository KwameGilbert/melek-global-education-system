const securityState={isEditMode:!1};async function handleSecuritySubmit(event){event.preventDefault();try{const currentPassword=document.getElementById("currentPassword").value,newPassword=document.getElementById("newPassword").value,confirmPassword=document.getElementById("confirmPassword").value;if(!currentPassword||!newPassword||!confirmPassword)throw new Error("All password fields are required");if(newPassword!==confirmPassword)throw new Error("New passwords do not match");showLoadingToast("Updating password...");const response=await fetch("../../../api/admin/adminSecurity.php",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"updatePassword",currentPassword:currentPassword,newPassword:newPassword,confirmPassword:confirmPassword})}),result=await response.json();if(!result.status)throw new Error(result.message);return showToast("Password updated successfully","success"),toggleSecurityEditMode(),!0}catch(error){return showToast(error.message,"error"),!1}}function toggleSecurityEditMode(){const form=document.getElementById("securityForm"),inputs=form.querySelectorAll('input[type="password"]'),submitBtn=form.querySelector('button[type="submit"]'),editBtn=document.getElementById("toggleSecurityEdit");securityState.isEditMode=!securityState.isEditMode,editBtn.innerHTML=securityState.isEditMode?'<i class="fas fa-times mr-2"></i>Cancel':'<i class="fas fa-edit mr-2"></i>Edit',editBtn.classList.toggle("bg-yellow-500"),editBtn.classList.toggle("hover:bg-yellow-600"),editBtn.classList.toggle("bg-gray-500"),editBtn.classList.toggle("hover:bg-gray-600"),inputs.forEach((input=>{input.readOnly=!securityState.isEditMode,input.value="",input.classList.toggle("bg-gray-50"),input.classList.toggle("bg-white")})),submitBtn.classList.toggle("hidden")}function setupPasswordToggles(){document.querySelectorAll(".toggle-password").forEach((button=>{button.onclick=function(e){e.preventDefault();const input=this.parentElement.querySelector("input"),icon=this.querySelector("i");input.type="password"===input.type?"text":"password",icon.classList.toggle("fa-eye"),icon.classList.toggle("fa-eye-slash")}}))}function initializeSecurity(){const securityForm=document.getElementById("securityForm");securityForm&&(securityForm.onsubmit=handleSecuritySubmit);const toggleSecurityEdit=document.getElementById("toggleSecurityEdit");toggleSecurityEdit&&(toggleSecurityEdit.onclick=toggleSecurityEditMode),setupPasswordToggles()}